!function(t){var e={init:function(o){var a=this;t.fn.stickyTable.defaults={tableClass:"",showExportBtn:!0,exporter:{type:"xls,pdf,png",isTwoSide:!1,position:"topright"},style:"",color:"green",customColor:[]},"undefined"!=typeof o&&(o.exporter=t.extend(t.fn.stickyTable.defaults.exporter,o.exporter)),o=t.extend(t.fn.stickyTable.defaults,o);var r={green:["#1bbc9b","#26a69a"],blue:["#3598dc","#4b77be"],red:["#e26a6a","#e35b5a"],yellow:["#f7ca18","#f3c200"],purple:["#9b59b6","#8e5fa2"],grey:["#afafaf","#95a5a6"],custom:[]};3==o.customColor.length&&(r.custom[0]=o.customColor[0],r.custom[1]=o.customColor[1],o.color="custom");var c=function(e,o,a,r,c){if(!e.is(":hidden")){e.find("thead th").each(function(e){o.find("th").eq(e).width(t(this).width())}).end().find("tr").each(function(e){a.find("tr").eq(e).height(t(this).height())}),o.width(e.outerWidth());var l=0;for(i=0;i<parseInt(c,10)-1;i++)l+=e.find("tbody tr:first-child th:nth-child("+i+")").width();a.find("th").add(r.find("th")).width(l),r.width(e.find("thead th").outerWidth()),r.find("tr").height(e.find("thead").height())}},l=function(t,e,o,a,r){if(!t.is(":hidden")){var c=n(t,e,o);o.add(r).css(t.height()>a.height()?a.scrollTop()>0?{opacity:1,top:a.scrollTop()}:{opacity:0,top:0}:e.scrollTop()>t.offset().top&&e.scrollTop()<t.offset().top+t.outerHeight()-c?{opacity:1,top:e.scrollTop()-t.offset().top}:{opacity:0,top:0})}},s=function(t,e,o,a){t.is(":hidden")||(e.scrollLeft()>0?o.add(a).css({opacity:1,left:e.scrollLeft()}):o.css({opacity:0}).add(a).css({left:0}))},n=function(e,o,a){var r=0;return e.find("tbody tr:lt(3)").each(function(){r+=t(this).height()}),r>.25*o.height()&&(r=.25*o.height()),r+=a.height()},d=function(e){var a="top right",r=!0,c="bottom right";switch(o.exporter.position){case"topleft":a="top left",c="bottom left";break;case"topright":a="top right",c="bottom right";break;case"bottomleft":a="bottom left",c="top left",r=!1;break;case"bottomright":a="bottom right",c="top right",r=!1}var l="",i=o.exporter.type.split(",");t.each(i,function(e,o){switch(t.trim(o)){case"xls":l+='<a class="stickytable-btn stickytable-btn-default stickytable-excel" href="javascript:;">Excel</a>';break;case"pdf":l+='<a class="stickytable-btn stickytable-btn-default stickytable-pdf" href="javascript:;">PDF</a>';break;case"png":l+='<a class="stickytable-btn stickytable-btn-default stickytable-png" href="javascript:;">PNG</a>'}}),$exportArea=t('<div class="stickytable-exportarea '+a+'">'+l+"</div>"),$exportArea2=t('<div class="stickytable-exportarea '+c+'">'+l+"</div>"),r?(e.prepend($exportArea),o.exporter.isTwoSide&&e.append($exportArea2)):(e.append($exportArea),o.exporter.isTwoSide&&e.prepend($exportArea2))};return t("body").off("click",".stickytable-excel"),t("body").on("click",".stickytable-excel",function(){var e="",o=t("table.stickytable-enabled",t(this).parent().parent()),a=o.clone();e+=a.prop("outerHTML");var c="<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:x='urn:schemas-microsoft-com:office:excel' xmlns='http://www.w3.org/TR/REC-html40'>";c+="<head>",c+="<!--[if gte mso 9]>",c+="<xml>",c+="<x:ExcelWorkbook>",c+="<x:ExcelWorksheets>",c+="<x:ExcelWorksheet>",c+="<x:Name>",c+="data",c+="</x:Name>",c+="<x:WorksheetOptions>",c+="<x:DisplayGridlines/>",c+="</x:WorksheetOptions>",c+="</x:ExcelWorksheet>",c+="</x:ExcelWorksheets>",c+="</x:ExcelWorkbook>",c+="</xml>",c+="<![endif]-->",c+="<style>",c+="table {border-collapse: collapse;margin-bottom: 3em;width: 100%;background: #fff;}",c+="td, th {padding: 0.75em 1.5em;}",c+="td {text-align: right;border-bottom: 1px solid #ccc;}",c+="td.odd {background-color: #f5f5f5;}",c+="th {background-color: "+r[o.attr("data-color")][0]+";font-weight: bold;color: #fff;white-space: nowrap;text-align:center;border: 1px solid #fff;}",c+="tbody th {background-color: "+r[o.attr("data-color")][1]+";text-align: left;}",c+="tbody tr.jumlah th {background-color: #31bc86;text-align: center;}",c+="tbody tr.jumlah td {font-weight: bold; background-color: #eee;}",c+="</style>",c+="</head>",c+="<body>",c+=e,c+="</body>",c+="</html>";var l="base64,"+t.base64.encode(c),i=document.createElement("a");i.href="data:application/vnd.ms-excel;"+l,i.download="result-export.xls",document.body.appendChild(i),i.click(),document.body.removeChild(i)}),t("body").off("click",".stickytable-pdf"),t("body").on("click",".stickytable-pdf",function(){var e=t(this),o=e.text();e.text(o+" ...");var a="",c=t("table.stickytable-enabled",t(this).parent().parent()),l=c.clone();a+=l.prop("outerHTML");var i="<html>";i+="<head>",i+="<style>",i+="table {border-collapse: collapse;margin-bottom: 3em;width: 100%;background: #fff;}",i+="th {background-color: "+r[c.attr("data-color")][0]+";font-weight: bold;color: #fff;white-space: nowrap;text-align:center;border: 1px solid #fff;}",i+="tbody th {background-color: "+r[c.attr("data-color")][1]+";text-align: left;}",i+="td {text-align: right; border-bottom: 1px solid #ccc;}",i+="</style>",i+="</head>",i+="<body>",i+=a,i+="</body>",i+="</html>";var s=new jsPDF("p","pt","letter"),n=s.canvas;n.height=792,n.width=612,html2pdf(i,s,function(t){var a=document.createElement("a");a.href=t.output("datauristring"),a.download="result-export.pdf",document.body.appendChild(a),a.click(),document.body.removeChild(a),e.text(o)})}),t("body").off("click",".stickytable-png"),t("body").on("click",".stickytable-png",function(){var e=t(this),o=e.text();e.text(o+" ...");var a="",c=t("table.stickytable-enabled",t(this).parent().parent()),l=c.clone();a+=l.prop("outerHTML");var i="<html>";i+="<head>",i+="<style>",i+="table {border-collapse: collapse;margin-bottom: 3em;width: 100%;background: #fff;}",i+="th {background-color: "+r[c.attr("data-color")][0]+";font-weight: bold;color: #fff;white-space: nowrap;text-align:center;border: 1px solid #fff;}",i+="tbody th {background-color: "+r[c.attr("data-color")][1]+";text-align: left;}",i+="td {text-align: right; border-bottom: 1px solid #ccc;}",i+="</style>",i+="</head>",i+="<body>",i+=a,i+="</body>",i+="</html>",i=i.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"");var s=document.createElement("iframe");s.setAttribute("style","height:1px; width:1px; opacity:0;"),document.body.appendChild(s);var n;n=s.contentDocument,(void 0==n||null==n)&&(n=s.contentWindow.document),n.open(),n.write(i),n.close(),html2canvas(n.body,{onrendered:function(t){var a=document.createElement("a");a.href=t.toDataURL("image/png"),a.download="result-export.png",document.body.appendChild(a),a.click(),document.body.removeChild(a),e.text(o)}})}),a.refresh=e.refresh,a.each(function(){if(!t(this).hasClass("stickytable")&&t(this).find("thead").length>0&&t(this).find("th").length>0)if(t(this).hasClass("stickytable-enabled")){var e=t(window),a=t(this),r=a.parent(),i=r.parent(),n=a.siblings(".stickytable-thead"),h=a.siblings(".stickytable-col"),b=a.siblings(".stickytable-intersect"),f="undefined"!=typeof a.find("thead th:first-child").attr("colspan")?parseInt(a.find("thead th:first-child").attr("colspan"),10):1;3==o.customColor.length?(t("thead th",a).css("background-color",o.customColor[0]),t("tbody th",a).css("background-color",o.customColor[1]),t("th",n).css("background-color",o.customColor[0]),t("th",h).css("background-color",o.customColor[1]),t("th",b).css("background-color",o.customColor[2])):(t("thead th",a).css("background-color",""),t("tbody th",a).css("background-color",""),t("th",n).css("background-color",""),t("th",h).css("background-color",""),t("th",b).css("background-color",""));var p=r.attr("data-clean").split(" ");t.each(p,function(e,o){r.removeClass(t.trim(o))}),r.addClass(o.style).addClass(o.color),r.attr("data-clean",o.style+" "+o.color),a.attr("data-color",o.color),a.addClass(o.tableClass),"undefined"!=typeof o.tableAttr&&t.each(o.tableAttr,function(t,e){a.attr(t,e)}),t(".stickytable-exportarea",i).remove(),o.showExportBtn&&d(i),c(a,n,h,b,f),l(a,e,n,r,b),s(a,r,h,b)}else{3==o.customColor.length&&(t("thead th",t(this)).css("background-color",o.customColor[0]),t("tbody th",t(this)).css("background-color",o.customColor[1]));var e=t(window),a=t(this),u=a.find("thead").clone(),y=a.find("thead, tbody").clone();a.addClass("stickytable-enabled").css({margin:0,width:"100%"}).wrap('<div class="stickytable-container" />').wrap('<div class="stickytable-wrap '+o.style+" "+o.color+'" data-clean="'+o.style+" "+o.color+'" />'),a.attr("data-color",o.color),a.addClass(o.tableClass),"undefined"!=typeof o.tableAttr&&t.each(o.tableAttr,function(t,e){a.attr(t,e)}),a.hasClass("overflow-y")&&a.removeClass("overflow-y").parent().addClass("overflow-y"),a.after('<table class="stickytable stickytable-thead" />'),a.find("tbody th").length>0&&a.after('<table class="stickytable stickytable-col" /><table class="stickytable stickytable-intersect" />');var n=t(this).siblings(".stickytable-thead"),h=t(this).siblings(".stickytable-col"),b=t(this).siblings(".stickytable-intersect"),r=t(this).parent(".stickytable-wrap"),i=t(this).parent().parent(".stickytable-container");n.append(u),h.append(y).find("thead th:gt(0)").remove().end().find("tbody td").remove();var f=("undefined"!=typeof a.find("thead th:first-child").attr("rowspan")?parseInt(a.find("thead th:first-child").attr("rowspan"),10):1,"undefined"!=typeof a.find("thead th:first-child").attr("colspan")?parseInt(a.find("thead th:first-child").attr("colspan"),10):1);b.html("<thead><tr><th>"+a.find("thead th:first-child").html()+"</th></tr></thead>"),3==o.customColor.length&&t("th",b).css("background-color",o.customColor[2]),c(a,n,h,b,f),a.parent(".stickytable-wrap").scroll(function(){l(a,e,n,r,b),s(a,r,h,b)}),e.load(function(){c(a,n,h,b,f),l(a,e,n,r,b),s(a,r,h,b)}).resize(function(){c(a,n,h,b,f),l(a,e,n,r,b),s(a,r,h,b)}).scroll(function(){l(a,e,n,r,b)}),o.showExportBtn&&d(i)}})},refresh:function(){"undefined"!=typeof this?this.each(function(){}):t.error("jQuery.stickyTable object doesn't exist.")}};t.fn.stickyTable=function(o){return e[o]?e[o].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof o&&o?void t.error("Method "+o+" does not exist on jQuery.stickyTable"):e.init.apply(this,arguments)}}(jQuery);